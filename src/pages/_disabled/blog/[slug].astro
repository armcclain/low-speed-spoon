---
import PostLayout from '../../layouts/PostLayout.astro';

export async function getStaticPaths() {
  // Load markdown posts from src/content/blog/*.md
  const posts = await Astro.glob('../../content/blog/*.md');

  return posts.map((post) => {
    // Derive slug from the file name, e.g., "a-gentle-beginning.md" -> "a-gentle-beginning"
    const file = (post.file || ''); // defensive
    const slug = file.split('/').pop()?.replace(/\.md$/, '') || 'post';

    return {
      params: { slug },
      props: { frontmatter: post.frontmatter, Content: post.Content },
    };
  });
}

const { frontmatter, Content } = Astro.props;
---

<PostLayout frontmatter={frontmatter}>
  <Content />
</PostLayout>
